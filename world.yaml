my_setting:
- &time_test 21600             # 测试节点延迟的间隔（秒）（自动切换节点的检测间隔）
- &time_update 18000        # 节点订阅更新的间隔（秒）（24h更新一次）
- &time_update_rule 18000  # 分流规则更新的间隔（秒）（7天更新一次）
- &test_url "http://www.apple.com/generate_204"  # 延迟测试链接 http://www.gstatic.com/generate_204 或 https://cp.cloudflare.com
###############################################################################

#################### 端口 | 模式 | 外部控制端口 ############################
mixed-port: 7891  # http代理 + socks代理
allow-lan: true
mode: rule
log-level: info
external-controller: 127.0.0.1:9090  
ipv6: false
#################### DNS | tap | 绕过fake-ip的域名 ############################
dns:
  enable: true
  ipv6: false
  listen: 0.0.0.0:53       # 开启tap：0.0.0.0:53 关闭tap：127.0.0.1:53
  enhanced-mode: fake-ip    # fake-ip 或 redir-host
  fake-ip-range: 198.18.0.1/16
  nameserver:
  - 119.29.29.29            # 腾讯 DNS
  - 223.5.5.5               # 阿里 DNS
  - 114.114.114.114
  - https://dns.alidns.com/dns-query
  - https://dns.pub/dns-query
  - https://rubyfish.cn/dns-query
  fallback:
  - https://dns.rubyfish.cn/dns-query
  - https://public.dns.iij.jp/dns-query
  - tls://8.8.4.4
  use-hosts: true
  fake-ip-filter:
  - '*.lan'
  - '*.localdomain'
  - '*.example'
  - '*.invalid'
  - '*.localhost'
  - '*.test'
  - '*.local'
  - '*.home.arpa'
  - time.*.com
  - time.*.gov
  - time.*.edu.cn
  - time.*.apple.com
  - time1.*.com
  - time2.*.com
  - time3.*.com
  - time4.*.com
  - time5.*.com
  - time6.*.com
  - time7.*.com
  - ntp.*.com
  - ntp1.*.com
  - ntp2.*.com
  - ntp3.*.com
  - ntp4.*.com
  - ntp5.*.com
  - ntp6.*.com
  - ntp7.*.com
  - '*.time.edu.cn'
  - '*.ntp.org.cn'
  - +.pool.ntp.org
  - time1.cloud.tencent.com
  - music.163.com
  - '*.music.163.com'
  - '*.126.net'
  - musicapi.taihe.com
  - music.taihe.com
  - songsearch.kugou.com
  - trackercdn.kugou.com
  - '*.kuwo.cn'
  - api-jooxtt.sanook.com
  - api.joox.com
  - joox.com
  - y.qq.com
  - '*.y.qq.com'
  - streamoc.music.tc.qq.com
  - mobileoc.music.tc.qq.com
  - isure.stream.qqmusic.qq.com
  - dl.stream.qqmusic.qq.com
  - aqqmusic.tc.qq.com
  - amobile.music.tc.qq.com
  - '*.xiami.com'
  - '*.music.migu.cn'
  - music.migu.cn
  - '*.msftconnecttest.com'
  - '*.msftncsi.com'
  - msftconnecttest.com
  - msftncsi.com
  - localhost.ptlogin2.qq.com
  - localhost.sec.qq.com
  - +.srv.nintendo.net
  - +.stun.playstation.net
  - xbox.*.microsoft.com
  - xnotify.xboxlive.com
  - +.battlenet.com.cn
  - +.wotgame.cn
  - +.wggames.cn
  - +.wowsgame.cn
  - +.wargaming.net
  - proxy.golang.org
  - stun.*.*
  - stun.*.*.*
  - +.stun.*.*
  - +.stun.*.*.*
  - +.stun.*.*.*.*
  - heartbeat.belkin.com
  - '*.linksys.com'
  - '*.linksyssmartwifi.com'
  - '*.router.asus.com'
  - mesu.apple.com
  - swscan.apple.com
  - swquery.apple.com
  - swdownload.apple.com
  - swcdn.apple.com
  - swdist.apple.com
  - lens.l.google.com
  - stun.l.google.com
  - +.nflxvideo.net
  - '*.square-enix.com'
  - '*.finalfantasyxiv.com'
  - '*.ffxiv.com'
  fallback-filter:
    geoip: true
    ipcidr:
      - 240.0.0.0/4
      - 0.0.0.0/32
      - 127.0.0.1/32
    domain:
      - +.google.com
      - +.facebook.com
      - +.twitter.com
      - +.youtube.com
      - +.xn--ngstr-lra8j.com
      - +.google.cn
      - +.googleapis.cn
      - +.googleapis.com
      - +.gvt1.com
tun:
  enable: true
  stack: system
  auto-detect-interface: true
  auto-route: true
  dns-hijack:
    - 198.18.0.2:53
################ 使用转换器 https://sub.dler.io 转换为 node list ##############
proxy-providers:
  DlerCloud-nodes:
    type: http
    path: ./nodes/DlerCloud-nodes.list
    url:
    interval: *time_update  # 订阅更新间隔（秒）
    health-check:
      enable: false
      url: *test_url
      interval: *time_test  # 测试间隔
  Nexitally-nodes:
    type: http
    path: ./nodes/Nexitally-nodes.list
    url:
    interval: *time_update
    health-check:
      enable: false
      url: *test_url
      interval: *time_test
  Other-nodes:
    type: http
    path: ./nodes/Other-nodes.list
    url: 
    interval: *time_update
    health-check:
      enable: false
      url: *test_url
      interval: *time_test
  Game-nodes:
    type: http
    path: ./nodes/Game-nodes.list
    url:
    interval: *time_update
    health-check:
      enable: false
      url: *test_url
      interval: *time_test
################################### 策略组 #################################### 
proxy-groups:
- name: PROXY
  type: select
  proxies:
  - Nexitally
  - DlerCloud
  - Other-node
  - Game
- name: GlobalTV
  type: select
  proxies:
  - PROXY
  - Media-Node
  - Nexitally
  - DlerCloud
  - Other-node
- name: AsianTV
  type: select
  proxies:
  - DIRECT
  - PROXY
  - Nexitally
  - DlerCloud
  - Other-node
- name: Nexitally
  type: select
  use:
  - Nexitally-nodes
- name: DlerCloud
  type: select
  use:
  - DlerCloud-nodes
- name: Other-node
  type: select
  use:
  - Other-nodes
- name: Game
  type: select
  disable-udp: false
  use:
  - Game-nodes
- name: Media-Node
  type: select
  use:
  - Nexitally
  - DlerCloud
- name: Final
  type: select
  proxies:
  - PROXY
  - DIRECT
- name: Speedtest 
  type: select
  proxies:
  - PROXY
  - DIRECT
rule-providers:
  apple-proxy:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/Hackl0us/SS-Rule-Snippet@master/Rulesets/Clash/Basic/Apple-proxy.yaml"
    path: ./ruleset/Apple-proxy.yaml
    interval: 3600
  apple-direct:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/Hackl0us/SS-Rule-Snippet@master/Rulesets/Clash/Basic/Apple-direct.yaml"
    path: ./ruleset/Apple-direct.yaml
    interval: 3600
  DisneyPlus:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/Hackl0us/SS-Rule-Snippet@master/Rulesets/Clash/App/stream/DisneyPlus.yaml"
    path: ./ruleset/DisneyPlus.yaml
    interval: 3600
  Netflix:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/Hackl0us/SS-Rule-Snippet@master/Rulesets/Clash/App/stream/Netflix.yaml"
    path: ./ruleset/Netflix.yaml
    interval: 3600	
  Steam:
    type: http
    behavior: classical
    url: "https://raw.dler.io/main/Clash/Provider/Steam.yaml"
    path: ./ruleset/Steam.yaml
    interval: 86400
  cn:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/Hackl0us/SS-Rule-Snippet@master/Rulesets/Clash/Basic/CN.yaml"
    path: ./ruleset/CN.yaml
    interval: 3600
  ad-keyword:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/Hackl0us/SS-Rule-Snippet@master/Rulesets/Clash/Basic/common-ad-keyword.yaml"
    path: ./ruleset/common-ad-keyword.yaml
    interval: 3600
  foreign:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/Hackl0us/SS-Rule-Snippet@master/Rulesets/Clash/Basic/foreign.yaml"
    path: ./ruleset/foreign.yaml
    interval: 3600
  telegram:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/Hackl0us/SS-Rule-Snippet@master/Rulesets/Clash/App/social/Telegram.yaml"
    path: ./ruleset/Telegram.yaml
    interval: 3600
  lan:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/Hackl0us/SS-Rule-Snippet@master/Rulesets/Clash/Basic/LAN.yaml"
    path: ./ruleset/LAN.yaml
    interval: 3600
############### rule模式 [从上至下匹配规则，越靠前优先级越高] ################
################ 若需要添加自定义规则，直接在下方修改即可 ####################
rules:
# 测速网站 | 测IP网站
- DOMAIN-KEYWORD,speedtest,Speedtest
- DOMAIN-KEYWORD,ooklaserver,Speedtest
- DOMAIN-SUFFIX,ipinfo.io,Speedtest
- DOMAIN-SUFFIX,ip.sb,Speedtest
- DOMAIN-SUFFIX,whoer.net,Speedtest
- DOMAIN-SUFFIX,speed.cloudflare.com,Speedtest
- DOMAIN-SUFFIX,fast.com,GlobalTV        # fast测速会走Netflix服务器
- DOMAIN-SUFFIX,steamcontent.tnkjmec.com,DIRECT #华为云
- DOMAIN-SUFFIX,eccdnx.com,DIRECT #白山云
- DOMAIN-SUFFIX,bscstorage.net,DIRECT
- DOMAIN-SUFFIX,pinyuncloud.com,DIRECT
- DOMAIN-SUFFIX,steam.clngaa.com,DIRECT #金山云
- DOMAIN-SUFFIX,mileweb.cs.steampowered.com.8686c.com,DIRECT #网宿云
- DOMAIN-SUFFIX,content.steamchina.com,DIRECT
############################ rule-set 远程规则 ################################
- RULE-SET,apple-proxy,PROXY
- RULE-SET,apple-direct,DIRECT
- RULE-SET,DisneyPlus,Media-Node
- RULE-SET,Netflix,Media-Node
- RULE-SET,Steam,PROXY
- RULE-SET,cn,DIRECT
- RULE-SET,ad-keyword,REJECT
- RULE-SET,foreign,PROXY
- RULE-SET,telegram,PROXY
- RULE-SET,lan,DIRECT
- DOMAIN-SUFFIX,smtp,DIRECT
- DOMAIN-SUFFIX,local,DIRECT
- IP-CIDR,10.0.0.0/8,DIRECT
- IP-CIDR,100.64.0.0/10,DIRECT
- IP-CIDR,127.0.0.0/8,DIRECT
- IP-CIDR,172.16.0.0/12,DIRECT
- IP-CIDR,192.168.0.0/16,DIRECT
- GEOIP,CN,DIRECT              # 使用geoip数据库匹配国内IP
- MATCH,Final
